{"openapi":"3.1.0","info":{"title":"C-Lens API","description":"\n# C-Lens Face Recognition Attendance System API\n\nA comprehensive backend system for managing educational courses with face recognition-based attendance tracking.\n\n## Features\n\n* **User Management**: Student and instructor registration with role-based access\n* **Face Recognition**: DeepFace-powered facial recognition for secure attendance\n* **Course Management**: Create courses, manage enrollments with join codes\n* **Attendance Tracking**: Real-time face-based attendance with accuracy metrics\n* **Assignment Management**: Create, submit, and grade assignments\n* **Content Sharing**: Announcements, notes, and surveys for course communication\n* **Secure Authentication**: JWT-based authentication with token management\n\n## Authentication Flow\n\n### 1. Registration\nRegister a new user account (student or instructor):\n```\nPOST /api/v1/auth/register\n```\n\n**Student Registration Example:**\n```json\n{\n  \"email\": \"student@university.edu\",\n  \"password\": \"SecurePass123\",\n  \"full_name\": \"John Doe\",\n  \"role\": \"student\",\n  \"student_number\": \"2024001\",\n  \"department\": \"Computer Engineering\",\n  \"class_level\": 2,\n  \"enrollment_year\": 2024\n}\n```\n\n**Instructor Registration Example:**\n```json\n{\n  \"email\": \"instructor@university.edu\",\n  \"password\": \"SecurePass123\",\n  \"full_name\": \"Dr. Jane Smith\",\n  \"role\": \"instructor\",\n  \"title\": \"Prof. Dr.\",\n  \"office_info\": \"A-101\"\n}\n```\n\n### 2. Login\nAuthenticate and receive an access token:\n```\nPOST /api/v1/auth/login\n```\n\n**Request:**\n```json\n{\n  \"email\": \"student@university.edu\",\n  \"password\": \"SecurePass123\"\n}\n```\n\n**Response:**\n```json\n{\n  \"access_token\": \"eyJ0eXAiOiJKV1QiLCJhbGc...\",\n  \"token_type\": \"bearer\",\n  \"user\": {\n    \"user_id\": 1,\n    \"email\": \"student@university.edu\",\n    \"full_name\": \"John Doe\",\n    \"role\": \"student\",\n    \"created_at\": \"2024-01-01T00:00:00Z\"\n  }\n}\n```\n\n### 3. Using Protected Endpoints\nInclude the access token in the Authorization header for all protected endpoints:\n```\nAuthorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGc...\n```\n\n### 4. Logout\nRevoke the access token:\n```\nPOST /api/v1/auth/logout\nAuthorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGc...\n```\n\n## Rate Limiting\n\nAll endpoints are rate-limited to 100 requests per minute per IP address to prevent abuse.\n\n## Error Responses\n\nThe API uses standard HTTP status codes:\n\n* **200 OK**: Request succeeded\n* **201 Created**: Resource created successfully\n* **400 Bad Request**: Invalid request data\n* **401 Unauthorized**: Authentication required or failed\n* **403 Forbidden**: Insufficient permissions\n* **404 Not Found**: Resource not found\n* **409 Conflict**: Resource conflict (e.g., duplicate email)\n* **422 Unprocessable Entity**: Validation error\n* **429 Too Many Requests**: Rate limit exceeded\n* **500 Internal Server Error**: Server error\n\n**Error Response Format:**\n```json\n{\n  \"detail\": \"Error message description\",\n  \"error_type\": \"ExceptionClassName\"\n}\n```\n\n## Security\n\n* Passwords are hashed using bcrypt\n* JWT tokens expire after 24 hours\n* Face embeddings are encrypted at rest\n* HTTPS required in production\n* SQL injection protection via parameterized queries\n* CORS configured for allowed origins only\n\n## Database\n\nPostgreSQL 15+ with the following main entities:\n* Users (students and instructors)\n* Courses and enrollments\n* Attendance sessions and records\n* Assignments and submissions\n* Announcements and shared notes\n* Surveys and responses\n\n## Face Recognition\n\nPowered by DeepFace library with support for multiple models:\n* Face detection and embedding extraction\n* Similarity comparison with configurable thresholds\n* Duplicate face detection\n* Encrypted storage of face embeddings\n","contact":{"name":"C-Lens Development Team","email":"support@clens.edu"},"license":{"name":"MIT License","url":"https://opensource.org/licenses/MIT"},"version":"1.0.0"},"paths":{"/health":{"get":{"summary":"Health Check","description":"Health check endpoint","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/":{"get":{"summary":"Root","description":"Root endpoint","operationId":"root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/v1/auth/register":{"post":{"tags":["Authentication"],"summary":"Register a new user","description":"Register a new user account as either a student or instructor.\n    \n    Upon successful registration, the user is automatically logged in and receives an access token.\n    \n    **Student Registration Requirements:**\n    - email (unique)\n    - password (min 8 chars, must contain letter and number)\n    - full_name\n    - role: \"student\"\n    - student_number (unique)\n    - department\n    - class_level (1-4)\n    - enrollment_year\n    \n    **Instructor Registration Requirements:**\n    - email (unique)\n    - password (min 8 chars, must contain letter and number)\n    - full_name\n    - role: \"instructor\"\n    - title (optional, e.g., \"Prof. Dr.\")\n    - office_info (optional, e.g., \"A-101\")\n    \n    **Password Requirements:**\n    - Minimum 8 characters\n    - Must contain at least one letter\n    - Must contain at least one number\n    \n    **Returns:**\n    - access_token: JWT token for authentication\n    - token_type: \"bearer\"\n    - user: User profile information","operationId":"register_api_v1_auth_register_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserCreate"}}},"required":true},"responses":{"201":{"description":"User successfully registered and authenticated","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenResponse"},"example":{"access_token":"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...","token_type":"bearer","user":{"user_id":1,"email":"student@university.edu","full_name":"John Doe","role":"student","created_at":"2024-01-01T00:00:00Z"}}}}},"400":{"description":"Invalid request data or missing required fields","content":{"application/json":{"example":{"detail":"Student registration requires: student_number, department, class_level, enrollment_year","error_type":"AppException"}}}},"409":{"description":"Email or student number already exists","content":{"application/json":{"example":{"detail":"Email already registered","error_type":"AppException"}}}},"422":{"description":"Validation error","content":{"application/json":{"example":{"detail":[{"loc":["body","password"],"msg":"Password must contain at least one number","type":"value_error"}]}}}}}}},"/api/v1/auth/login":{"post":{"tags":["Authentication"],"summary":"Login user","description":"Authenticate a user with email and password credentials.\n    \n    Upon successful authentication, returns a JWT access token that must be included\n    in the Authorization header for all protected endpoints.\n    \n    **Token Usage:**\n    ```\n    Authorization: Bearer <access_token>\n    ```\n    \n    **Token Expiration:**\n    - Access tokens expire after 24 hours\n    - After expiration, users must login again\n    \n    **Security:**\n    - Passwords are verified using bcrypt\n    - Failed login attempts are logged\n    - Rate limiting applies (100 requests/minute)","operationId":"login_api_v1_auth_login_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginRequest"}}},"required":true},"responses":{"200":{"description":"Successfully authenticated","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenResponse"},"example":{"access_token":"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...","token_type":"bearer","user":{"user_id":1,"email":"student@university.edu","full_name":"John Doe","role":"student","created_at":"2024-01-01T00:00:00Z"}}}}},"401":{"description":"Invalid credentials","content":{"application/json":{"example":{"detail":"Invalid email or password"}}}},"422":{"description":"Validation error","content":{"application/json":{"example":{"detail":[{"loc":["body","email"],"msg":"value is not a valid email address","type":"value_error.email"}]}}}}}}},"/api/v1/auth/logout":{"post":{"tags":["Authentication"],"summary":"Logout user","description":"Logout the current user by revoking their access token.\n    \n    This endpoint requires a valid JWT token in the Authorization header.\n    Once logged out, the token can no longer be used to access protected endpoints.\n    \n    **Required Header:**\n    ```\n    Authorization: Bearer <access_token>\n    ```\n    \n    **Security:**\n    - Token is immediately revoked from the database\n    - Revoked tokens cannot be reused\n    - Users must login again to obtain a new token","operationId":"logout_api_v1_auth_logout_post","responses":{"200":{"description":"Successfully logged out","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LogoutResponse"},"example":{"message":"Logged out successfully"}}}},"401":{"description":"Invalid or missing token","content":{"application/json":{"example":{"detail":"Not authenticated"}}}},"404":{"description":"Token not found or already revoked","content":{"application/json":{"example":{"detail":"Token not found or already revoked"}}}}},"security":[{"HTTPBearer":[]},{"HTTPBearer":[]}]}},"/api/v1/debug/tables":{"get":{"tags":["Debug"],"summary":"List all database tables","description":"**Development Only Endpoint**\n    \n    Lists all tables in the database with their column information.\n    This endpoint is only available in development environment.\n    \n    Returns:\n    - Table names\n    - Column names and types for each table\n    - Row counts","operationId":"list_tables_api_v1_debug_tables_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","title":"Response List Tables Api V1 Debug Tables Get"}}}}}}},"/api/v1/debug/table/{table_name}":{"get":{"tags":["Debug"],"summary":"Get table data","description":"**Development Only Endpoint**\n    \n    Retrieves all data from a specific table.\n    \n    Parameters:\n    - **table_name**: Name of the table to query\n    - **limit**: Maximum number of rows to return (default: 100)\n    \n    Returns:\n    - Table data as list of dictionaries\n    - Column names\n    - Total row count","operationId":"get_table_data_api_v1_debug_table__table_name__get","parameters":[{"name":"table_name","in":"path","required":true,"schema":{"type":"string","title":"Table Name"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":100,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","title":"Response Get Table Data Api V1 Debug Table  Table Name  Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"BearerAuth":[]}]}},"/api/v1/debug/stats":{"get":{"tags":["Debug"],"summary":"Database statistics","description":"**Development Only Endpoint**\n    \n    Provides quick statistics about the database:\n    - Total number of tables\n    - Row counts for each table\n    - Database size information","operationId":"database_stats_api_v1_debug_stats_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","title":"Response Database Stats Api V1 Debug Stats Get"}}}}}}},"/api/v1/debug/clear-table/{table_name}":{"post":{"tags":["Debug"],"summary":"Clear table data","description":"**Development Only Endpoint - USE WITH CAUTION**\n    \n    Deletes all data from a specific table.\n    This operation cannot be undone!\n    \n    Parameters:\n    - **table_name**: Name of the table to clear\n    \n    Returns:\n    - Number of rows deleted","operationId":"clear_table_api_v1_debug_clear_table__table_name__post","parameters":[{"name":"table_name","in":"path","required":true,"schema":{"type":"string","title":"Table Name"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","title":"Response Clear Table Api V1 Debug Clear Table  Table Name  Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"BearerAuth":[]}]}}},"components":{"schemas":{"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"LoginRequest":{"properties":{"email":{"type":"string","format":"email","title":"Email"},"password":{"type":"string","title":"Password"}},"type":"object","required":["email","password"],"title":"LoginRequest","description":"Schema for user login request"},"LogoutResponse":{"properties":{"message":{"type":"string","title":"Message","default":"Logged out successfully"}},"type":"object","title":"LogoutResponse","description":"Schema for logout response"},"TokenResponse":{"properties":{"access_token":{"type":"string","title":"Access Token"},"token_type":{"type":"string","title":"Token Type","default":"bearer"},"user":{"$ref":"#/components/schemas/UserResponse"}},"type":"object","required":["access_token","user"],"title":"TokenResponse","description":"Schema for authentication token response"},"UserCreate":{"properties":{"email":{"type":"string","format":"email","title":"Email"},"full_name":{"type":"string","maxLength":100,"minLength":1,"title":"Full Name"},"password":{"type":"string","maxLength":100,"minLength":8,"title":"Password"},"role":{"type":"string","pattern":"^(student|instructor)$","title":"Role"},"student_number":{"anyOf":[{"type":"string","maxLength":20,"minLength":1},{"type":"null"}],"title":"Student Number"},"department":{"anyOf":[{"type":"string","maxLength":100,"minLength":1},{"type":"null"}],"title":"Department"},"class_level":{"anyOf":[{"type":"integer","maximum":4.0,"minimum":1.0},{"type":"null"}],"title":"Class Level"},"enrollment_year":{"anyOf":[{"type":"integer","maximum":2100.0,"minimum":1900.0},{"type":"null"}],"title":"Enrollment Year"},"title":{"anyOf":[{"type":"string","maxLength":50},{"type":"null"}],"title":"Title"},"office_info":{"anyOf":[{"type":"string","maxLength":100},{"type":"null"}],"title":"Office Info"}},"type":"object","required":["email","full_name","password","role"],"title":"UserCreate","description":"Schema for user registration"},"UserResponse":{"properties":{"email":{"type":"string","format":"email","title":"Email"},"full_name":{"type":"string","maxLength":100,"minLength":1,"title":"Full Name"},"user_id":{"type":"integer","title":"User Id"},"role":{"type":"string","title":"Role"},"created_at":{"type":"string","format":"date-time","title":"Created At"}},"type":"object","required":["email","full_name","user_id","role","created_at"],"title":"UserResponse","description":"Schema for user response"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}},"securitySchemes":{"BearerAuth":{"type":"http","scheme":"bearer","bearerFormat":"JWT","description":"Enter your JWT token obtained from /api/v1/auth/login endpoint. Format: Bearer <token>"}},"examples":{"StudentRegistration":{"summary":"Student Registration","value":{"email":"student@university.edu","password":"SecurePass123","full_name":"John Doe","role":"student","student_number":"2024001","department":"Computer Engineering","class_level":2,"enrollment_year":2024}},"InstructorRegistration":{"summary":"Instructor Registration","value":{"email":"instructor@university.edu","password":"SecurePass123","full_name":"Dr. Jane Smith","role":"instructor","title":"Prof. Dr.","office_info":"A-101"}},"LoginRequest":{"summary":"Login Request","value":{"email":"student@university.edu","password":"SecurePass123"}},"TokenResponse":{"summary":"Successful Authentication","value":{"access_token":"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...","token_type":"bearer","user":{"user_id":1,"email":"student@university.edu","full_name":"John Doe","role":"student","created_at":"2024-01-01T00:00:00Z"}}},"ErrorResponse":{"summary":"Error Response","value":{"detail":"Invalid credentials","error_type":"AuthenticationError"}},"ValidationError":{"summary":"Validation Error","value":{"detail":[{"loc":["body","email"],"msg":"value is not a valid email address","type":"value_error.email"}]}}}},"tags":[{"name":"Authentication","description":"User registration, login, and logout operations. All users must authenticate to access protected endpoints."},{"name":"Face Recognition","description":"Face registration and verification endpoints using DeepFace. Used for attendance tracking and identity verification."},{"name":"Students","description":"Student profile management and academic information retrieval."},{"name":"Instructors","description":"Instructor profile management and course oversight."},{"name":"Courses","description":"Course creation, enrollment management, and course information."},{"name":"Attendances","description":"Attendance session management and face-based check-in operations."},{"name":"Assignments","description":"Assignment creation, submission, and grading operations."},{"name":"Announcements","description":"Course announcements, notes, and resource sharing."},{"name":"Notes","description":"Student-to-student note sharing within courses."},{"name":"Surveys","description":"Course surveys and feedback collection."},{"name":"Debug","description":"**Development Only** - Database inspection and debugging tools. View tables, data, and statistics."}]}